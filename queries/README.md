# ðŸ” SPL Detection Logic Library

This directory contains the core **Search Processing Language (SPL)** queries used to power the Cyber-Sentinel SIEM dashboard. These queries are designed to transform raw log data into actionable security intelligence.

## ðŸ› ï¸ Query Logic Overview

Each query in this library follows a specific detection strategy:

### 1. Brute Force Detection (`T1110`)
* **Logic:** Aggregates failed login events from `auth.log` and filters for high-frequency attempts from a single source.
* **Threshold:** > 5 failures in 5 minutes.
* **Action:** Triggers a "High Severity" alert for the SOC team to investigate the Source IP.

### 2. Privilege Escalation (`T1548`)
* **Logic:** Monitors `syslog` for `sudo` execution errors where the user is not in the `sudoers` file.
* **Impact:** Identifies "Insider Threats" or compromised low-privilege accounts attempting to gain root access.

### 3. System Health & Persistence
* **Logic:** Parses custom logs generated by the **Bash-Admin-Toolkit**.
* **Action:** Monitors for critical service failures (`systemd`) and hardware resource exhaustion (Disk/CPU).



---

## ðŸ—ºï¸ MITRE ATT&CK Mapping
To ensure industry-standard coverage, these queries are mapped to the following MITRE techniques:

| Query Name | MITRE ID | Tactic |
| :--- | :--- | :--- |
| SSH Brute Force | T1110 | Initial Access |
| Unauthorized Sudo | T1548.003 | Privilege Escalation |
| Service Manipulation| T1543 | Persistence |
| Log Clearing | T1070.001 | Defense Evasion |

---

## ðŸš€ How to use these Queries
1.  Copy the desired query from `security_alerts.spl`.
2.  Paste into the **Splunk Search & Reporting** app.
3.  Adjust the `index` and `sourcetype` fields to match your specific environment configuration.
4.  (Optional) Click **Save As > Alert** to automate the detection.
